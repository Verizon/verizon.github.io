import React from 'react';
import PropTypes from 'prop-types';
import styled from 'styled-components';
import { calculateRem } from '@uie/javascript-style-helpers';

import { Fonts } from '../../fonts';

const propTypes = {
  primitive: PropTypes.oneOf(['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'p', 'span']),
  children: PropTypes.node,
};

const defaultProps = {
  children: null,
  primitive: 'p',
  fontsconfig: Fonts,
};

/**
 * @ignore
 */
const StyledTypography = styled(props => {
  return React.createElement(props.primitive, props, props.children);
})`
  font-size: ${({ fontSize }) => calculateRem(fontSize)};
  font-weight: ${({ fontWeight }) => fontWeight};
  line-height: ${({ lineheight }) => calculateRem(lineheight)};
  font-family: ${({ fontFamily }) => fontFamily};
  letter-spacing: ${({ letterSpacing }) =>
    letterSpacing && calculateRem(letterSpacing)};
  color: ${({ color }) => color};
  margin: 0;
  text-decoration: none;
`;

/**
 * @ignore
 */
const Typography = props => {
  const { primitive, children, fontsconfig } = props;

  if (!Fonts.checkFontLoaded) {
    fontsconfig.loadFonts();
  }

  return (
    <StyledTypography {...props} primitive={primitive}>
      {children}
    </StyledTypography>
  );
};

Typography.propTypes = propTypes;
Typography.defaultProps = defaultProps;

export default Typography;
